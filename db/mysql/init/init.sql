CREATE DATABASE IF NOT EXISTS dev;
USE dev;

CREATE TABLE IF NOT EXISTS accounts (
	username VARCHAR(25) PRIMARY KEY,
	password VARCHAR(25) NOT NULL
);

CREATE TABLE IF NOT EXISTS apps (
	id SMALLINT(6) AUTO_INCREMENT PRIMARY KEY,
	name VARCHAR(25) NOT NULL,
	username VARCHAR(25) NOT NULL,
	oauth_consumer_key CHAR(32),
	oauth_token CHAR(34),
	oauth_token_secret CHAR(16),
	CONSTRAINT FK_username
		FOREIGN KEY (username)
		REFERENCES accounts (username),
	CONSTRAINT UC_oauth_consumer_key UNIQUE (oauth_consumer_key)
);

CREATE TABLE IF NOT EXISTS authlist(
	id SMALLINT(6) NOT NULL,
	username VARCHAR(25) NOT NULL,
	oauth_token CHAR(34),
	oauth_token_secret CHAR(16),
	CONSTRAINT FK_auth_username
		FOREIGN KEY (username)
		REFERENCES accounts (username),
	CONSTRAINT FK_auth_appid
		FOREIGN KEY (id)
		REFERENCES apps (id),
	CONSTRAINT UC_auth UNIQUE (id, username)
);