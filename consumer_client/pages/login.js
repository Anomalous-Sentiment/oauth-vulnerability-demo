import styles from '../styles/Home.module.css'
import Form from 'react-bootstrap/Form';
import Button from 'react-bootstrap/Button';
import { useState } from 'react';
import { useRouter } from 'next/router'
import Alert from 'react-bootstrap/Alert';
import 'bootstrap/dist/css/bootstrap.min.css';

export default function Login() {
  const router = useRouter();
  const [username, setUsername] = useState('');
  const [password, setPassword] = useState('');
  const [showError, setShow] = useState(false)

  function handleLogin()
  {
    const body = {'username' : username, 'password': password}
    fetch('api/login', {
      method: 'Post',
      body: JSON.stringify(body)
    })
    .then(res => {
      return res.json()
    })
    .then((json) => {
      //Check if succcessful login
      if (json['loggedIn'])
      {
        //If successful, redirect to main page
        router.push('/')
      }
      else
      {
        setShow(true)
      }
    })
  }


  return (
    <div className={styles.container}>
      <div className={styles.loginBox}>
        <h1>Login</h1>
        <Form.Label htmlFor="usernameInput">Username</Form.Label>
        <Form.Control
            type="text"
            id="usernameInput"
            value={username}
            onChange={(event) => setUsername(event.target.value)}
        />
        <Form.Label htmlFor="passwordInput">Password</Form.Label>
        <Form.Control
            type="password"
            id="passwordInput"
            value={password}
            onChange={(event) => setPassword(event.target.value)}
        />
        <Button
        onClick={handleLogin}>
          Login
        </Button>
        {showError &&
          <Alert variant='danger'>
          Error. Incorrect username or password entered.
          </Alert>
        }

      </div>
    </div>
  )
}
