import styles from '../styles/Home.module.css'
import NavigationBar from '../components/NavigationBar'
import { withSessionSsr } from "../lib/withSession";

export const getServerSideProps = withSessionSsr(
  async function getServerSideProps({ req }) {
    var currUser = null;

    //Check if session exists
    if (req.session.user && req.session.user.loggedIn)
    {
        currUser = req.session.user;
    }
    else
    {
        //Redirect back to login page if not logged in (no session)
        return {
            redirect: {
              destination: '/login',
              permanent: false,
            }
        }
    }


    return {
      props: {
        username: currUser.username,
      },
    };
  },
);

export default function resources({username})
{
    
    return(
        <div className={styles.container}>
            <div className={styles.loginBox}>
            <NavigationBar/>
            <h1>
            Service Provider Resources
            </h1>
            <h2>
                Information
            </h2>
            <p>
                This is a page which will display the service provider resources that you have authorised this app to access.
            </p>
            <h2>
                You are logged in as: {username}
            </h2>
            <h3>
                Authorised Resources:
            </h3>
            </div>
        </div>
    )
}